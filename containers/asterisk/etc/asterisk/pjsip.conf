[global]
; Set global settings here

[transport-udp]
type=transport
protocol=udp
bind=0.0.0.0:5160

[transport-tcp]
type=transport
protocol=tcp
bind=0.0.0.0:5161

[transport-tls]
type=transport
protocol=tls
bind=0.0.0.0:5162
cert_file=/etc/asterisk/keys/asterisk.crt
priv_key_file=/etc/asterisk/keys/asterisk.key
verify_client=no
require_client_cert=no

[transport-ws]
type=transport
protocol=ws
bind=0.0.0.0:8088

[transport-wss]
type=transport
protocol=wss
bind=0.0.0.0:8089

; ---------- Home Assistant (sipjs-card) ----------
; Zugangsdaten kommen via env/entrypoint – Defaults gesetzt
; HOMEASSISTANT_USER / HOMEASSISTANT_PASS

[ha-auth]
type=auth
auth_type=userpass
username=${HOMEASSISTANT_USER:-homeassistant}
password=${HOMEASSISTANT_PASS:-Caliba#355}

[ha-aor]
type=aor
max_contacts=1
remove_existing=yes

[ha-endpoint]
type=endpoint
transport=transport-wss            ; Browser nutzt WSS
aors=ha-aor
auth=ha-auth
context=public                     ; Dialplan-Kontext
disallow=all
allow=opus,ulaw,alaw               ; Opus zuerst für Browser
direct_media=no

; NAT / ICE / WebRTC
webrtc=yes                         ; setzt sinnvolle Defaults
rtp_symmetric=yes
force_rport=yes
rewrite_contact=yes
ice_support=yes
rtcp_mux=yes

; Medien: DTLS-SRTP für Browser
media_encryption=dtls
dtls_setup=actpass                 ; Browser=actpass/active, passt gut
; (DTLS nutzt automatisch die Zertifikate aus transport-wss)

